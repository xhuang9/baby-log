---
last_verified_at: 2025-12-31T15:30:00Z
source_paths:
  - src/app/[locale]/(auth)/layout.tsx
  - src/utils/AppConfig.ts
---

# Clerk Authentication Localization

## Purpose
Integrates Clerk authentication UI with next-intl locale detection for consistent English-first auth experience.

## Key Deviations from Standard
- Clerk localization configured per-locale in ClerkProvider (English only by default)
- Uses official @clerk/localizations package
- Locale selection synchronized with next-intl
- Auth URLs dynamically generated based on current locale

## Clerk Localization Configuration

### Location: `src/utils/AppConfig.ts`
```typescript
import { enUS } from '@clerk/localizations';

const supportedLocales: Record<string, LocalizationResource> = {
  en: enUS,
};

export const ClerkLocalizations = {
  defaultLocale: enUS,
  supportedLocales,
};
```

Maps locale codes to Clerk localization objects.

## ClerkProvider Integration

### Location: `src/app/[locale]/(auth)/layout.tsx`
```typescript
import { ClerkProvider } from '@clerk/nextjs';
import { ClerkLocalizations } from '@/utils/AppConfig';

const clerkLocale = ClerkLocalizations.supportedLocales[locale]
  ?? ClerkLocalizations.defaultLocale;

return (
  <ClerkProvider
    localization={clerkLocale}
    signInUrl={signInUrl}
    signUpUrl={signUpUrl}
    // ...
  >
    {props.children}
  </ClerkProvider>
);
```

Dynamically selects Clerk localization based on current locale.

## Locale-Aware Auth URLs

### Dynamic URL Generation
```typescript
let signInUrl = '/sign-in';
let signUpUrl = '/sign-up';
let dashboardUrl = '/dashboard';
let afterSignOutUrl = '/';

// Add locale prefix for non-default locales
if (locale !== routing.defaultLocale) {
  signInUrl = `/${locale}${signInUrl}`;
  signUpUrl = `/${locale}${signUpUrl}`;
  dashboardUrl = `/${locale}${dashboardUrl}`;
  afterSignOutUrl = `/${locale}${afterSignOutUrl}`;
}
```

**Result:**
- English (`en`): `/sign-in`, `/sign-up`, `/dashboard`

## Adding New Locale

### 1. Install Clerk Localization
```bash
npm install @clerk/localizations
```

Check available localizations: https://clerk.com/docs/localization

### 2. Update AppConfig
```typescript
import { deDE, enUS, esES } from '@clerk/localizations';

const supportedLocales: Record<string, LocalizationResource> = {
  en: enUS,
  es: esES,
  de: deDE, // Add new locale
};

export const AppConfig = {
  locales: ['en', 'es', 'de'], // Add to locales array
  // ...
};
```

### 3. Add Translation File
Create `src/locales/de.json` (or let Crowdin generate it).

## Important Patterns

### Accessing Clerk User with Locale
```typescript
import { auth } from '@clerk/nextjs/server';
import { getLocale } from 'next-intl/server';

const { userId } = await auth();
const locale = await getLocale();

// Redirect to locale-specific sign-in
if (!userId) {
  const signInUrl = locale === 'en' ? '/sign-in' : `/${locale}/sign-in`;
  redirect(signInUrl);
}
```

### Clerk Components with Tailwind CSS v4
```typescript
<ClerkProvider
  appearance={{
    cssLayerName: 'clerk', // Ensures compatibility with Tailwind CSS v4
  }}
  // ...
>
```

The `cssLayerName` prevents CSS conflicts between Clerk and Tailwind CSS v4.

## Clerk UI Translation Coverage

Official Clerk localizations include:
- Sign-in form labels and errors
- Sign-up form labels and errors
- User profile UI
- Organization management UI
- Error messages
- Button labels

## Gotchas / Constraints

- Clerk localization is separate from app translations (two systems)
- Not all languages supported by Clerk (check docs)
- Clerk UI language changes require page reload
- Fallback to `defaultLocale` if locale not supported by Clerk
- Custom Clerk components may need manual translation

## Related Systems
- `.readme/chunks/i18n.routing-integration.md` - Locale routing
- `.readme/chunks/auth.clerk-layout-pattern.md` - ClerkProvider scoping
