---
last_verified_at: 2026-01-10T00:00:00Z
source_paths:
  - src/app/[locale]/layout.tsx
  - src/lib/i18n.ts
  - src/lib/i18n-routing.ts
  - src/lib/i18n-navigation.ts
  - src/config/app.ts
---

# Internationalization Routing Integration

## Purpose
Describes how next-intl integrates with Next.js App Router using locale-prefixed routes and "as-needed" mode.

## Key Deviations from Standard
- Uses "as-needed" locale prefix mode (default locale has NO prefix)
- ALL routes under `src/app/[locale]/` - mandatory locale segment
- Default locale (`en`) accessible at `/about`; non-default locales use `/{locale}/about` when added
- Locale detection via `[locale]` dynamic segment, not middleware

## Locale Prefix Configuration

### Mode: "as-needed"
Defined in `src/config/app.ts`:
```typescript
const localePrefix: LocalePrefixMode = 'as-needed';

export const AppConfig = {
  name: 'Nextjs Starter',
  locales: ['en'],
  defaultLocale: 'en',
  localePrefix,
};
```

### URL Structure
| Locale | Path     | URL    |
|--------|----------|--------|
| en     | /about   | /about |
| en     | /        | /      |

Default locale (`en`) has no prefix. Additional locales require prefix when added.

## Route Implementation

### Root Layout: `src/app/[locale]/layout.tsx`
```typescript
export default async function RootLayout(props: {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
}) {
  const { locale } = await props.params;

  // Validate locale
  if (!hasLocale(routing.locales, locale)) {
    notFound();
  }

  // Required for static rendering
  setRequestLocale(locale);

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider>
          {props.children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

### Static Params Generation
```typescript
export function generateStaticParams() {
  return routing.locales.map(locale => ({ locale }));
}
```

Generates pages for each locale at build time.

## I18n Navigation Helpers

### Import from `@/lib/i18n-navigation.ts`
```typescript
import { usePathname } from '@/lib/i18n-navigation';

// Get current pathname without locale
const pathname = usePathname();
// Returns: /about (not /es/about)
```

### Routing Configuration: `src/lib/i18n-routing.ts`
```typescript
import { defineRouting } from 'next-intl/routing';
import { AppConfig } from '@/config/app';

export const routing = defineRouting({
  locales: AppConfig.locales,
  defaultLocale: AppConfig.defaultLocale,
  localePrefix: AppConfig.localePrefix,
});
```

## Important Patterns

### Creating Locale-Aware Links
```typescript
import Link from 'next/link';

// Standard Next.js Link works with locale routing
<Link href="/dashboard">Dashboard</Link>

// Never hardcode locale
<Link href="/es/dashboard">Dashboard</Link> // ‚ùå Wrong
```

### Server-Side Locale Access
```typescript
import { getLocale, getTranslations } from 'next-intl/server';

// Get current locale
const locale = await getLocale(); // 'en'

// Get translations
const t = await getTranslations('HomePage');
const title = t('title');
```

### Client-Side Locale Access
```typescript
'use client';
import { useLocale, useTranslations } from 'next-intl';

const locale = useLocale(); // 'en'
const t = useTranslations('HomePage');
```

## Gotchas / Constraints

- Must call `setRequestLocale(locale)` in layout for static rendering
- Never create routes outside `[locale]` - breaks i18n
- API routes are locale-prefixed when additional locales are enabled
- Locale switcher must reload page (not SPA navigation) when multiple locales are enabled
- Default locale (`en`) accessible with or without prefix: `/` and `/en/` both work

## Related Systems
- `.readme/chunks/i18n.translation-workflow.md` - Managing translation files
- `.readme/chunks/i18n.clerk-localization.md` - Auth UI translations
- `.readme/chunks/architecture.route-structure.md` - Route organization
